### Step-Level Generative Flow Networks (GFlowNets) for Mathematical Reasoning in LLMs

Generative Flow Networks (GFlowNets) have been introduced as a method to sample a diverse set of candidates in an active learning context, with a training objective that makes them approximately sample in proportion to a given reward function. They can be used to estimate joint probability distributions and the corresponding marginal distributions where some variables are unspecified and, of particular interest, can represent distributions over composite objects like sets and graphs. GFlowNets amortize the work typically done by computationally expensive MCMC methods in a single but trained generative pass. They could also be used to estimate partition functions and free energies, conditional probabilities of supersets (supergraphs) given a subset (subgraph), as well as marginal distributions over all supersets (supergraphs) of a given set (graph). GFlowNets operate as flow-based systems, where the probability of generating a specific output is modeled as a flow through a directed acyclic graph. This approach enables GFlowNets to promote diversity in generated solutions while maintaining alignment with the reward signal. For more details, refer to the foundational [GFlowNets paper]([https://arxiv.org/abs/2111.09266]).

In this work, we adapt GFlowNets to operate at the reasoning step level by leveraging a modified version of the Sub-TB Loss, originally introduced in [Amortizing intractable inference in large language models](https://arxiv.org/abs/2310.04363), which we further adjusted to function in a step-level context rather than a token-level context, aiming to enhance mathematical reasoning in Large Language Models (LLMs). Traditional reinforcement learning methods typically focus on maximizing a single reward signal, which can lead to limited exploration and solution diversity. In contrast, GFlowNets naturally encourage diverse solution strategies while preserving accuracy, making them particularly well-suited for complex reasoning tasks.

This work highlights the potential of GFlowNets as a powerful tool for developing more robust, diverse, and versatile mathematical reasoning capabilities in LLMs, paving the way for future advancements in AI-driven problem-solving.

<p align="center">
  <img src="./images/reward.png" alt="Reward earned during FineTuning" width="55%">
  <img src="./images/loss.png" alt="Loss" width="55%">
</p>
